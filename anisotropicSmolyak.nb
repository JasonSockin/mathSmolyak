Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 "A ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " Implementation of Judd, Maliar, Maliar and Valero\[CloseCurlyQuote]s \
Anisotropic Smolyak Grid Method"
}], "Title"],

Cell["by", "Author",
 TextAlignment->Center],

Cell["Gary Anderson", "Author",
 TextAlignment->Center],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<mathSmolyak`\>\"", "]"}]], "Code"],

Cell[CellGroupData[{

Cell["\<\
Implementation of Nested Grid Points, Section 2.2.1 and 3.2.1\
\>", "Section"],

Cell["\<\
Implementation of nested grid points insection 2.2.1\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"unidimNestedGridPoints", "[", "ii", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"ii", ",", "4"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["1", 
      SqrtBox["2"]], ",", "0", ",", 
     RowBox[{"-", 
      FractionBox["1", 
       SqrtBox["2"]]}], ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"Cos", "[", 
      FractionBox["\[Pi]", "8"], "]"}], ",", 
     FractionBox["1", 
      SqrtBox["2"]], ",", 
     RowBox[{"Sin", "[", 
      FractionBox["\[Pi]", "8"], "]"}], ",", "0", ",", 
     RowBox[{"-", 
      RowBox[{"Sin", "[", 
       FractionBox["\[Pi]", "8"], "]"}]}], ",", 
     RowBox[{"-", 
      FractionBox["1", 
       SqrtBox["2"]]}], ",", 
     RowBox[{"-", 
      RowBox[{"Cos", "[", 
       FractionBox["\[Pi]", "8"], "]"}]}], ",", 
     RowBox[{"-", "1"}]}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"unidimDisjointSetsPts", "[", "ii", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"ii", ",", "4"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       SqrtBox["2"]]}], ",", 
     FractionBox["1", 
      SqrtBox["2"]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Cos", "[", 
       FractionBox["\[Pi]", "8"], "]"}]}], ",", 
     RowBox[{"Cos", "[", 
      FractionBox["\[Pi]", "8"], "]"}], ",", 
     RowBox[{"-", 
      RowBox[{"Sin", "[", 
       FractionBox["\[Pi]", "8"], "]"}]}], ",", 
     RowBox[{"Sin", "[", 
      FractionBox["\[Pi]", "8"], "]"}]}], "}"}]}], "}"}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Implementation of Disjoint Sets of Polynomials Section 3.3.1\
\>", "Section"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"unidimDisjointSetsPolys", "[", "ii", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"ii", ",", "4"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"xx", ",", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["xx", "2"]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "3"}], " ", "xx"}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["xx", "3"]}]}], ",", 
     RowBox[{"1", "-", 
      RowBox[{"8", " ", 
       SuperscriptBox["xx", "2"]}], "+", 
      RowBox[{"8", " ", 
       SuperscriptBox["xx", "4"]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"5", " ", "xx"}], "-", 
      RowBox[{"20", " ", 
       SuperscriptBox["xx", "3"]}], "+", 
      RowBox[{"16", " ", 
       SuperscriptBox["xx", "5"]}]}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"18", " ", 
       SuperscriptBox["xx", "2"]}], "-", 
      RowBox[{"48", " ", 
       SuperscriptBox["xx", "4"]}], "+", 
      RowBox[{"32", " ", 
       SuperscriptBox["xx", "6"]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "7"}], " ", "xx"}], "+", 
      RowBox[{"56", " ", 
       SuperscriptBox["xx", "3"]}], "-", 
      RowBox[{"112", " ", 
       SuperscriptBox["xx", "5"]}], "+", 
      RowBox[{"64", " ", 
       SuperscriptBox["xx", "7"]}]}], ",", 
     RowBox[{"1", "-", 
      RowBox[{"32", " ", 
       SuperscriptBox["xx", "2"]}], "+", 
      RowBox[{"160", " ", 
       SuperscriptBox["xx", "4"]}], "-", 
      RowBox[{"256", " ", 
       SuperscriptBox["xx", "6"]}], "+", 
      RowBox[{"128", " ", 
       SuperscriptBox["xx", "8"]}]}]}], "}"}]}], "}"}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Implementation of TensorProduct  Disjoint Sets of Points and Polynomials \
Section 3.2.3 and 3.3.3\
\>", "Section"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tensorProdDisjointPts", "[", 
  RowBox[{"{", 
   RowBox[{"2", ",", "4"}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", 
        RowBox[{"Cos", "[", 
         FractionBox["\[Pi]", "8"], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"Cos", "[", 
        FractionBox["\[Pi]", "8"], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", 
         FractionBox["\[Pi]", "8"], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"Sin", "[", 
        FractionBox["\[Pi]", "8"], "]"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", 
        RowBox[{"Cos", "[", 
         FractionBox["\[Pi]", "8"], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"Cos", "[", 
        FractionBox["\[Pi]", "8"], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", 
         FractionBox["\[Pi]", "8"], "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"Sin", "[", 
        FractionBox["\[Pi]", "8"], "]"}]}], "}"}]}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tensorProdDisjointPolys", "[", 
  RowBox[{"{", 
   RowBox[{"2", ",", "4"}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"xx", "[", "1", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"5", " ", 
         RowBox[{"xx", "[", "2", "]"}]}], "-", 
        RowBox[{"20", " ", 
         SuperscriptBox[
          RowBox[{"xx", "[", "2", "]"}], "3"]}], "+", 
        RowBox[{"16", " ", 
         SuperscriptBox[
          RowBox[{"xx", "[", "2", "]"}], "5"]}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"xx", "[", "1", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"18", " ", 
         SuperscriptBox[
          RowBox[{"xx", "[", "2", "]"}], "2"]}], "-", 
        RowBox[{"48", " ", 
         SuperscriptBox[
          RowBox[{"xx", "[", "2", "]"}], "4"]}], "+", 
        RowBox[{"32", " ", 
         SuperscriptBox[
          RowBox[{"xx", "[", "2", "]"}], "6"]}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"xx", "[", "1", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "7"}], " ", 
         RowBox[{"xx", "[", "2", "]"}]}], "+", 
        RowBox[{"56", " ", 
         SuperscriptBox[
          RowBox[{"xx", "[", "2", "]"}], "3"]}], "-", 
        RowBox[{"112", " ", 
         SuperscriptBox[
          RowBox[{"xx", "[", "2", "]"}], "5"]}], "+", 
        RowBox[{"64", " ", 
         SuperscriptBox[
          RowBox[{"xx", "[", "2", "]"}], "7"]}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"xx", "[", "1", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"32", " ", 
         SuperscriptBox[
          RowBox[{"xx", "[", "2", "]"}], "2"]}], "+", 
        RowBox[{"160", " ", 
         SuperscriptBox[
          RowBox[{"xx", "[", "2", "]"}], "4"]}], "-", 
        RowBox[{"256", " ", 
         SuperscriptBox[
          RowBox[{"xx", "[", "2", "]"}], "6"]}], "+", 
        RowBox[{"128", " ", 
         SuperscriptBox[
          RowBox[{"xx", "[", "2", "]"}], "8"]}]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"xx", "[", "1", "]"}], "2"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"5", " ", 
         RowBox[{"xx", "[", "2", "]"}]}], "-", 
        RowBox[{"20", " ", 
         SuperscriptBox[
          RowBox[{"xx", "[", "2", "]"}], "3"]}], "+", 
        RowBox[{"16", " ", 
         SuperscriptBox[
          RowBox[{"xx", "[", "2", "]"}], "5"]}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"xx", "[", "1", "]"}], "2"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"18", " ", 
         SuperscriptBox[
          RowBox[{"xx", "[", "2", "]"}], "2"]}], "-", 
        RowBox[{"48", " ", 
         SuperscriptBox[
          RowBox[{"xx", "[", "2", "]"}], "4"]}], "+", 
        RowBox[{"32", " ", 
         SuperscriptBox[
          RowBox[{"xx", "[", "2", "]"}], "6"]}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"xx", "[", "1", "]"}], "2"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "7"}], " ", 
         RowBox[{"xx", "[", "2", "]"}]}], "+", 
        RowBox[{"56", " ", 
         SuperscriptBox[
          RowBox[{"xx", "[", "2", "]"}], "3"]}], "-", 
        RowBox[{"112", " ", 
         SuperscriptBox[
          RowBox[{"xx", "[", "2", "]"}], "5"]}], "+", 
        RowBox[{"64", " ", 
         SuperscriptBox[
          RowBox[{"xx", "[", "2", "]"}], "7"]}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"xx", "[", "1", "]"}], "2"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"32", " ", 
         SuperscriptBox[
          RowBox[{"xx", "[", "2", "]"}], "2"]}], "+", 
        RowBox[{"160", " ", 
         SuperscriptBox[
          RowBox[{"xx", "[", "2", "]"}], "4"]}], "-", 
        RowBox[{"256", " ", 
         SuperscriptBox[
          RowBox[{"xx", "[", "2", "]"}], "6"]}], "+", 
        RowBox[{"128", " ", 
         SuperscriptBox[
          RowBox[{"xx", "[", "2", "]"}], "8"]}]}], ")"}]}]}], "}"}]}], 
  "}"}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Implementation of Sparse Grid Points and Polynomials Using  Disjoint Sets  \
Section 3.2.3 and 3.3.3\
\>", "Section"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"sparseGridPts", "[", 
    RowBox[{"2", ",", "ii"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"ii", ",", "0", ",", "2"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", 
        FractionBox["1", 
         SqrtBox["2"]]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       FractionBox["1", 
        SqrtBox["2"]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", 
         SqrtBox["2"]]}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["1", 
        SqrtBox["2"]], ",", "0"}], "}"}]}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"sparseGridPolys", "[", 
    RowBox[{"2", ",", "ii"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"ii", ",", "0", ",", "2"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"xx", "[", "2", "]"}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"xx", "[", "2", "]"}], "2"]}]}], ",", 
     RowBox[{"xx", "[", "1", "]"}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"xx", "[", "1", "]"}], "2"]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"xx", "[", "2", "]"}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"xx", "[", "2", "]"}], "2"]}]}], ",", 
     RowBox[{"xx", "[", "1", "]"}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"xx", "[", "1", "]"}], "2"]}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "3"}], " ", 
       RowBox[{"xx", "[", "2", "]"}]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox[
        RowBox[{"xx", "[", "2", "]"}], "3"]}]}], ",", 
     RowBox[{"1", "-", 
      RowBox[{"8", " ", 
       SuperscriptBox[
        RowBox[{"xx", "[", "2", "]"}], "2"]}], "+", 
      RowBox[{"8", " ", 
       SuperscriptBox[
        RowBox[{"xx", "[", "2", "]"}], "4"]}]}], ",", 
     RowBox[{
      RowBox[{"xx", "[", "1", "]"}], " ", 
      RowBox[{"xx", "[", "2", "]"}]}], ",", 
     RowBox[{
      RowBox[{"xx", "[", "1", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"xx", "[", "2", "]"}], "2"]}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"xx", "[", "1", "]"}], "2"]}]}], ")"}], " ", 
      RowBox[{"xx", "[", "2", "]"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"xx", "[", "1", "]"}], "2"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"xx", "[", "2", "]"}], "2"]}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "3"}], " ", 
       RowBox[{"xx", "[", "1", "]"}]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox[
        RowBox[{"xx", "[", "1", "]"}], "3"]}]}], ",", 
     RowBox[{"1", "-", 
      RowBox[{"8", " ", 
       SuperscriptBox[
        RowBox[{"xx", "[", "1", "]"}], "2"]}], "+", 
      RowBox[{"8", " ", 
       SuperscriptBox[
        RowBox[{"xx", "[", "1", "]"}], "4"]}]}]}], "}"}]}], "}"}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Implementation of Anisotropic Sparse Grid Points and Polynomials Using  \
Disjoint Sets  Section 4\
\>", "Section"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sparseGridPts", "[", 
  RowBox[{"{", 
   RowBox[{"2", ",", "3"}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      FractionBox["1", 
       SqrtBox["2"]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["1", 
      SqrtBox["2"]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       SqrtBox["2"]]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", 
      SqrtBox["2"]], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      RowBox[{"Cos", "[", 
       FractionBox["\[Pi]", "8"], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"Cos", "[", 
      FractionBox["\[Pi]", "8"], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      RowBox[{"Sin", "[", 
       FractionBox["\[Pi]", "8"], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"Sin", "[", 
      FractionBox["\[Pi]", "8"], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", 
      FractionBox["1", 
       SqrtBox["2"]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     FractionBox["1", 
      SqrtBox["2"]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", 
      FractionBox["1", 
       SqrtBox["2"]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox["1", 
      SqrtBox["2"]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       SqrtBox["2"]]}], ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", 
       SqrtBox["2"]]}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", 
      SqrtBox["2"]], ",", 
     RowBox[{"-", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", 
      SqrtBox["2"]], ",", "1"}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sparseGridPolys", "[", 
  RowBox[{"{", 
   RowBox[{"2", ",", "3"}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{"xx", "[", "2", "]"}], ",", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"xx", "[", "2", "]"}], "2"]}]}], ",", 
   RowBox[{"xx", "[", "1", "]"}], ",", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"xx", "[", "1", "]"}], "2"]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "3"}], " ", 
     RowBox[{"xx", "[", "2", "]"}]}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox[
      RowBox[{"xx", "[", "2", "]"}], "3"]}]}], ",", 
   RowBox[{"1", "-", 
    RowBox[{"8", " ", 
     SuperscriptBox[
      RowBox[{"xx", "[", "2", "]"}], "2"]}], "+", 
    RowBox[{"8", " ", 
     SuperscriptBox[
      RowBox[{"xx", "[", "2", "]"}], "4"]}]}], ",", 
   RowBox[{
    RowBox[{"xx", "[", "1", "]"}], " ", 
    RowBox[{"xx", "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"xx", "[", "1", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"xx", "[", "2", "]"}], "2"]}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"xx", "[", "1", "]"}], "2"]}]}], ")"}], " ", 
    RowBox[{"xx", "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"xx", "[", "1", "]"}], "2"]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"xx", "[", "2", "]"}], "2"]}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "3"}], " ", 
     RowBox[{"xx", "[", "1", "]"}]}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox[
      RowBox[{"xx", "[", "1", "]"}], "3"]}]}], ",", 
   RowBox[{"1", "-", 
    RowBox[{"8", " ", 
     SuperscriptBox[
      RowBox[{"xx", "[", "1", "]"}], "2"]}], "+", 
    RowBox[{"8", " ", 
     SuperscriptBox[
      RowBox[{"xx", "[", "1", "]"}], "4"]}]}], ",", 
   RowBox[{
    RowBox[{"5", " ", 
     RowBox[{"xx", "[", "2", "]"}]}], "-", 
    RowBox[{"20", " ", 
     SuperscriptBox[
      RowBox[{"xx", "[", "2", "]"}], "3"]}], "+", 
    RowBox[{"16", " ", 
     SuperscriptBox[
      RowBox[{"xx", "[", "2", "]"}], "5"]}]}], ",", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"18", " ", 
     SuperscriptBox[
      RowBox[{"xx", "[", "2", "]"}], "2"]}], "-", 
    RowBox[{"48", " ", 
     SuperscriptBox[
      RowBox[{"xx", "[", "2", "]"}], "4"]}], "+", 
    RowBox[{"32", " ", 
     SuperscriptBox[
      RowBox[{"xx", "[", "2", "]"}], "6"]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "7"}], " ", 
     RowBox[{"xx", "[", "2", "]"}]}], "+", 
    RowBox[{"56", " ", 
     SuperscriptBox[
      RowBox[{"xx", "[", "2", "]"}], "3"]}], "-", 
    RowBox[{"112", " ", 
     SuperscriptBox[
      RowBox[{"xx", "[", "2", "]"}], "5"]}], "+", 
    RowBox[{"64", " ", 
     SuperscriptBox[
      RowBox[{"xx", "[", "2", "]"}], "7"]}]}], ",", 
   RowBox[{"1", "-", 
    RowBox[{"32", " ", 
     SuperscriptBox[
      RowBox[{"xx", "[", "2", "]"}], "2"]}], "+", 
    RowBox[{"160", " ", 
     SuperscriptBox[
      RowBox[{"xx", "[", "2", "]"}], "4"]}], "-", 
    RowBox[{"256", " ", 
     SuperscriptBox[
      RowBox[{"xx", "[", "2", "]"}], "6"]}], "+", 
    RowBox[{"128", " ", 
     SuperscriptBox[
      RowBox[{"xx", "[", "2", "]"}], "8"]}]}], ",", 
   RowBox[{
    RowBox[{"xx", "[", "1", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "3"}], " ", 
       RowBox[{"xx", "[", "2", "]"}]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox[
        RowBox[{"xx", "[", "2", "]"}], "3"]}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"xx", "[", "1", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"8", " ", 
       SuperscriptBox[
        RowBox[{"xx", "[", "2", "]"}], "2"]}], "+", 
      RowBox[{"8", " ", 
       SuperscriptBox[
        RowBox[{"xx", "[", "2", "]"}], "4"]}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"xx", "[", "1", "]"}], "2"]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "3"}], " ", 
       RowBox[{"xx", "[", "2", "]"}]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox[
        RowBox[{"xx", "[", "2", "]"}], "3"]}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"xx", "[", "1", "]"}], "2"]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"8", " ", 
       SuperscriptBox[
        RowBox[{"xx", "[", "2", "]"}], "2"]}], "+", 
      RowBox[{"8", " ", 
       SuperscriptBox[
        RowBox[{"xx", "[", "2", "]"}], "4"]}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "3"}], " ", 
       RowBox[{"xx", "[", "1", "]"}]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox[
        RowBox[{"xx", "[", "1", "]"}], "3"]}]}], ")"}], " ", 
    RowBox[{"xx", "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "3"}], " ", 
       RowBox[{"xx", "[", "1", "]"}]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox[
        RowBox[{"xx", "[", "1", "]"}], "3"]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"xx", "[", "2", "]"}], "2"]}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"8", " ", 
       SuperscriptBox[
        RowBox[{"xx", "[", "1", "]"}], "2"]}], "+", 
      RowBox[{"8", " ", 
       SuperscriptBox[
        RowBox[{"xx", "[", "1", "]"}], "4"]}]}], ")"}], " ", 
    RowBox[{"xx", "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"8", " ", 
       SuperscriptBox[
        RowBox[{"xx", "[", "1", "]"}], "2"]}], "+", 
      RowBox[{"8", " ", 
       SuperscriptBox[
        RowBox[{"xx", "[", "1", "]"}], "4"]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"xx", "[", "2", "]"}], "2"]}]}], ")"}]}]}], "}"}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Implementation of Anisotropic Sparse Grid Evaluation Producing  the Matrix in \
Equation 22\
\>", "Section"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"thePts", ",", "thePolys", ",", "theMatrix"}], "}"}], "=", 
  RowBox[{"sparseGridEvalPolysAtPts", "[", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"xx", "[", "2", "]"}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"xx", "[", "2", "]"}], "2"]}]}], ",", 
     RowBox[{"xx", "[", "1", "]"}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"xx", "[", "1", "]"}], "2"]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", 
       RowBox[{"-", "1"}], ",", "0", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "0", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", 
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], "}"}]}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"thePts", ",", "thePolys", ",", "theMatrix"}], "}"}], "=", 
  RowBox[{"sparseGridEvalPolysAtPts", "[", 
   RowBox[{"2", ",", "1"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"xx", "[", "2", "]"}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"xx", "[", "2", "]"}], "2"]}]}], ",", 
     RowBox[{"xx", "[", "1", "]"}], ",", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"xx", "[", "1", "]"}], "2"]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", 
       RowBox[{"-", "1"}], ",", "0", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "0", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "0", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", 
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", 
       RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], "}"}]}], 
  "}"}]], "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{740, 818},
WindowMargins->{{29, Automatic}, {Automatic, 50}},
FrontEndVersion->"8.0 for Linux x86 (64-bit) (February 23, 2011)",
StyleDefinitions->"Default.nb"
]

